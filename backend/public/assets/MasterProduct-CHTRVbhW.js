import{_ as q,a as G}from"./UiParentCard.vue_vue_type_script_setup_true_lang-DnD-5gIF.js";import{O as d,P as K,_ as H,$ as i,q as J,o as X,a as o,w as s,d as m,a0 as r,f as p,e as v,V as D,A as x,a1 as ee,b as n,a2 as S,F as ae}from"./index-CGGVM91c.js";import{B as te}from"./main-Dfa23GB-.js";import{_ as le}from"./NewModal-RG6-e5WE.js";import{d as oe}from"./theme-bootstrap-maRaUoWN.js";import{u as se}from"./auth-B63OrgMx.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={class:"d-flex align-center mb-4"},ue={class:"main-container"},ie={class:"list-container"},re={class:"form-wrapper"},me={class:"add"},ce={__name:"MasterProduct",setup(fe){var C;const u=oe.useToast(),R=se(),A=ee,w=new Date().toISOString().split("T")[0],a=d({prdCode:"",prdName:"",writer:((C=R.user)==null?void 0:C.name)||"",date:w,size:"",safeQT:"",unit:"",type:"",note:""}),c=d([]),U=d([{checkboxSelection:!0,width:50},{field:"제품코드",editable:!0,width:140},{field:"제품명",width:140,editable:!0},{field:"제품유형",width:140,editable:!0},{field:"규격",width:140,editable:!0},{field:"단위",width:130,editable:!0},{field:"안전재고",flex:1,editable:!0},{field:"작성자",width:110},{field:"등록일자",width:110},{field:"비고",width:110,editable:!0}]),I=d({title:"제품 관리"}),Q=K([{title:"기준정보",disabled:!0,href:"#"},{title:"제품 관리",disabled:!1,href:"#"}]),P=d([]),V=d([]),T=d(null),g=d(""),y=d([]),h=d([]),k=[{field:"그룹코드",headerName:"그룹코드",flex:1},{field:"규격",headerName:"규격",flex:1},{field:"사용유무",headerName:"사용유무",flex:1}],E=d([]),b=d(null);H(()=>{_(),Y(),M(),z()});const _=async()=>{const l=await i.get("http://localhost:3000/masterPrdSelect");c.value=l.data.map(e=>({제품코드:e.PRD_CODE,제품명:e.PRD_NAME,제품유형:e.PRD_TYPE,규격:e.PRD_SIZE,단위:e.PRD_UNIT,안전재고:e.PRD_SAFEQT,작성자:e.PRD_WRITER,등록일자:e.PRD_DATE.substring(0,10),비고:e.PRD_NOTE}))},M=async()=>{const l=await i.get("http://localhost:3000/masterPrdUnit");P.value=l.data.map(e=>e.code_name)},z=async()=>{const l=await i.get("http://localhost:3000/masterPrdType");V.value=l.data.map(e=>e.code_name)},O=async()=>{if(!a.value.safeQT||!a.value.type){u.warning("값을 올바르게 기재하십시오.",{position:"top-right",duration:1e3});return}if(a.value.prdCode){const l={PRD_NAME:a.value.prdName,PRD_TYPE:a.value.type,PRD_UNIT:a.value.unit,PRD_SIZE:a.value.size,PRD_SAFEQT:a.value.safeQT,PRD_WRITER:a.value.writer,PRD_DATE:a.value.date,PRD_NOTE:a.value.note,PRD_CODE:a.value.prdCode};await i.post("http://localhost:3000/masterPrdUpdate",l),u.success("제품이 수정되었습니다.",{position:"top-right",duration:1e3})}else{if(c.value.find(t=>t.제품명===a.value.prdName)){u.warning("이미 등록된 제품입니다.",{position:"top-right",duration:1e3});return}const e={PRD_NAME:a.value.prdName,PRD_TYPE:a.value.type,PRD_UNIT:a.value.unit,PRD_SIZE:a.value.size,PRD_SAFEQT:a.value.safeQT,PRD_WRITER:a.value.writer,PRD_DATE:a.value.date,PRD_NOTE:a.value.note};await i.post("http://localhost:3000/masterPrdInsert",e),u.success("제품이 등록되었습니다.",{position:"top-right",duration:1e3})}await _()},F=async()=>{const l=b.value.getSelectedRows();if(l.length===0){u.warning("삭제할 제품을 선택하세요.",{position:"top-right",duration:1e3});return}if(!confirm(`${l.map(t=>t.제품명).join(", ")}을 삭제하시겠습니까?`))return;const e=l.map(t=>t.제품코드);await i.post("http://localhost:3000/masterPrdDelete",{prdCode:e}),await _(),u.success("제품이 삭제되었습니다.",{position:"top-right",duration:1e3})},f=d(""),$=async()=>{if(!f.value){u.warning("제품이 입력되지 않았습니다",{position:"top-right",duration:1e3});return}const l={PRD_NAME:f.value},e=await i.post("http://localhost:3000/masterPrdSearch",l);c.value=e.data.map(t=>({제품코드:t.PRD_CODE,제품명:t.PRD_NAME,제품유형:t.PRD_TYPE,규격:t.PRD_SIZE,단위:t.PRD_UNIT,안전재고:t.PRD_SAFEQT,작성자:t.PRD_WRITER,등록일자:t.PRD_DATE.substring(0,10),비고:t.PRD_NOTE})),u.success("검색이 완료되었습니다.",{position:"top-right",duration:1e3})},B=()=>{var l;a.value={prdCode:"",prdName:"",writer:((l=R.user)==null?void 0:l.name)||"",date:w,size:"",safeQT:"",unit:"",type:"",note:""}},L=l=>{a.value.prdCode=l.data.제품코드,a.value.prdName=l.data.제품명,a.value.writer=l.data.작성자,a.value.date=l.data.등록일자,a.value.safeQT=l.data.안전재고,a.value.size=l.data.규격,a.value.unit=l.data.단위,a.value.type=l.data.제품유형,a.value.note=l.data.비고},W=l=>{b.value=l.api},Y=async()=>{const l=await i.get("http://localhost:3000/masterPrdModal");E.value=l.data.map(e=>({그룹코드:e.group_code,규격:e.code_name,사용유무:e.use_yn}))},Z=async(l,e,t)=>{var N;g.value=l,y.value=e,h.value=t,(N=T.value)==null||N.open()},j=async l=>{a.value.size=l.규격};return(l,e)=>(X(),J(ae,null,[o(q,{title:I.value.title,breadcrumbs:Q.value},null,8,["title","breadcrumbs"]),o(G,{title:"제품 목록"},{default:s(()=>[m("div",ne,[o(r,{label:"제품 검색",modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=t=>f.value=t),"hide-details":"",class:"mr-2",style:{"max-width":"280px"}},null,8,["modelValue"]),o(p,{color:"darkText",onClick:$},{default:s(()=>e[11]||(e[11]=[v("검색")])),_:1}),o(D,{justify:"end",class:"mr-3"},{default:s(()=>[o(p,{color:"error",class:"mr-1",onClick:F},{default:s(()=>e[12]||(e[12]=[v("삭제")])),_:1})]),_:1})]),m("div",ue,[m("div",ie,[o(x(te),{rowData:c.value,columnDefs:U.value,theme:x(A),style:{height:"500px",width:"100%"},onCellValueChanged:l.onCellValueChanged,rowSelection:"single",onRowClicked:L,onGridReady:W},null,8,["rowData","columnDefs","theme","onCellValueChanged"])]),m("div",re,[m("div",me,[o(D,{class:"mb-4"},{default:s(()=>[o(n,{cols:"6"},{default:s(()=>[o(r,{label:"제품코드",modelValue:a.value.prdCode,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.prdCode=t),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(n,{cols:"6"},{default:s(()=>[o(r,{label:"제품명",modelValue:a.value.prdName,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.prdName=t),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(n,{cols:"6"},{default:s(()=>[o(r,{label:"작성자",modelValue:a.value.writer,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.writer=t),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(n,{cols:"6"},{default:s(()=>[o(r,{label:"등록일자",modelValue:a.value.date,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.date=t),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(n,{cols:"6"},{default:s(()=>[o(r,{label:"규격",modelValue:a.value.size,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.size=t),placeholder:"규격",dense:"",outlined:"",readonly:""},{"append-inner":s(()=>[m("i",{class:"fa-solid fa-magnifying-glass",style:{cursor:"pointer","font-size":"large","margin-right":"0.5rem"},onClick:e[5]||(e[5]=t=>Z("제품 규격 조회",E.value,k))})]),_:1},8,["modelValue"]),o(le,{ref_key:"modalRef",ref:T,title:g.value,rowData:y.value,colDefs:h.value,onConfirm:j},null,8,["title","rowData","colDefs"])]),_:1}),o(n,{cols:"6"},{default:s(()=>[o(r,{label:"안전재고",modelValue:a.value.safeQT,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value.safeQT=t),type:"number",min:"0",outlined:""},null,8,["modelValue"])]),_:1}),o(n,{cols:"6"},{default:s(()=>[o(S,{label:"단위",modelValue:a.value.unit,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value.unit=t),items:P.value,dense:"",outlined:""},null,8,["modelValue","items"])]),_:1}),o(n,{cols:"6"},{default:s(()=>[o(S,{label:"제품유형",modelValue:a.value.type,"onUpdate:modelValue":e[9]||(e[9]=t=>a.value.type=t),items:V.value,dense:"",outlined:""},null,8,["modelValue","items"])]),_:1}),o(n,{cols:"12"},{default:s(()=>[o(r,{label:"비고",modelValue:a.value.note,"onUpdate:modelValue":e[10]||(e[10]=t=>a.value.note=t),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(D,{justify:"center"},{default:s(()=>[o(p,{color:"error",class:"mr-3",onClick:B},{default:s(()=>e[13]||(e[13]=[v("초기화")])),_:1}),o(p,{color:"primary",class:"mr-6",onClick:O},{default:s(()=>e[14]||(e[14]=[v("저장")])),_:1})]),_:1})]),_:1})])])])]),_:1})],64))}},Ve=de(ce,[["__scopeId","data-v-565cc7f6"]]);export{Ve as default};
