import{x as w,aU as h,aV as B,aX as M,O as i,P as F,a6 as O,y as E,_ as j,q as k,a as t,w as o,F as L,$ as P,o as c,d as I,c as U,k as q,V as H,b as u,a0 as f,a2 as Q,f as p,e as b,aQ as $,A as y,a1 as J}from"./index-CGGVM91c.js";import{_ as K,a as W}from"./UiParentCard.vue_vue_type_script_setup_true_lang-DnD-5gIF.js";import{B as X}from"./main-Dfa23GB-.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G=w({__name:"MaterialListHistory",setup(Z){h.registerModules([B,M]);const v=J,N=i({title:"원자재검수이력조회"}),_=F([{title:"품질",disabled:!0,href:"#"},{title:"원자재검수이력조회",disabled:!1,href:"#"}]),l=O({materialName:"",status:"",inspector:""}),n=i([]),d=i(!1),g=i([{label:"합격",value:"합격"},{label:"불합격",value:"불합격"}]),T=E(()=>{const a=l.materialName.trim().toLowerCase(),e=l.status,r=l.inspector;return n.value.filter(s=>{const x=!a||s.materialCode.toLowerCase().includes(a),D=s.rjtReason&&s.rjtReason.trim()!==""?"불합격":"합격",R=!e||D===e,A=!r||s.createdBy&&s.createdBy>=r;return x&&R&&A}).map(s=>({...s,status:s.rjtReason&&s.rjtReason.trim()!==""?"불합격":"합격"}))}),V=i([{headerName:"검사번호",field:"inspectionNo",flex:1,resizable:!0,suppressSizeToFit:!0},{headerName:"입고번호",field:"receiptNo",flex:1,resizable:!0,suppressSizeToFit:!0},{headerName:"원자재코드",field:"materialCode",flex:1,resizable:!0,suppressSizeToFit:!0},{headerName:"총수량",field:"qty",flex:1,resizable:!0,suppressSizeToFit:!0},{headerName:"처리상태",field:"status",flex:1,resizable:!0,suppressSizeToFit:!0,cellRenderer:a=>a.value||"-"},{headerName:"검사완료일자",field:"createdBy",flex:1,resizable:!0,cellRenderer:a=>a.value?new Date(a.value).toISOString().split("T")[0]:"-"},{headerName:"불합격사유",field:"rjtReason",flex:1,resizable:!0,suppressSizeToFit:!0}]),C=i({defaultColDef:{flex:1,minWidth:100,resizable:!0},pagination:!0,paginationAutoPageSize:!0,paginationPageSizeSelector:!0}),m=async()=>{try{d.value=!0;const a=await P.get("http://localhost:3000/mathisall");console.log("result data는 => ",a.data),a.data&&Array.isArray(a.data)?n.value=a.data.map(e=>({inspectionNo:e.MAT_CERT_ID||"",receiptNo:e.RECEIPT_NO||"",materialCode:e.MAT_CODE||"",qty:Number(e.TOTAL_QTY)||0,status:e.MAT_STATUS||"",createdBy:e.Q_CHECKED_DATE||"",rjtReason:e.RJT_REASON||""})):n.value=[]}catch(a){console.error("데이터 조회 중 오류 발생:",a),n.value=[]}finally{d.value=!1}};function z(){l.materialName="",l.status="",l.inspector=""}function S(){m()}return j(async()=>{await m()}),(a,e)=>(c(),k(L,null,[t(K,{title:N.value.title,breadcrumbs:_.value},null,8,["title","breadcrumbs"]),t(W,null,{default:o(()=>[t(H,{class:"mb-4"},{default:o(()=>[t(u,{cols:"3"},{default:o(()=>[t(f,{label:"원자재명",modelValue:l.materialName,"onUpdate:modelValue":e[0]||(e[0]=r=>l.materialName=r),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(u,{cols:"3"},{default:o(()=>[t(Q,{label:"처리상태",modelValue:l.status,"onUpdate:modelValue":e[1]||(e[1]=r=>l.status=r),items:g.value,"item-title":"label","item-value":"value",dense:"",outlined:""},null,8,["modelValue","items"])]),_:1}),t(u,{cols:"3"},{default:o(()=>[t(f,{label:"검사완료일자",modelValue:l.inspector,"onUpdate:modelValue":e[2]||(e[2]=r=>l.inspector=r),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(u,{justify:"end"},{default:o(()=>[t(p,{color:"primary",variant:"elevated",onClick:S,class:"mr-2"},{default:o(()=>e[3]||(e[3]=[b("조회")])),_:1}),t(p,{color:"error",variant:"elevated",onClick:z},{default:o(()=>e[4]||(e[4]=[b("초기화")])),_:1})]),_:1})]),_:1}),e[5]||(e[5]=I("br",null,null,-1)),d.value?(c(),U($,{key:0,indeterminate:"",color:"primary"})):q("",!0),t(y(X),{rowData:T.value,columnDefs:V.value,theme:y(v),gridOptions:C.value,style:{height:"400px"}},null,8,["rowData","columnDefs","theme","gridOptions"])]),_:1})],64))}}),se=Y(G,[["__scopeId","data-v-e745ed1f"]]);export{se as default};
