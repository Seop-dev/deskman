import{x as P,aU as U,aV as Q,aX as $,O as n,P as I,a6 as B,y as k,_ as q,q as F,a as r,w as o,F as Y,$ as g,o as j,V as b,b as m,a0 as y,a2 as H,f as v,e as N,A as S,a1 as W,H as X}from"./index-CGGVM91c.js";import{_ as G,a as J}from"./UiParentCard.vue_vue_type_script_setup_true_lang-DnD-5gIF.js";import{B as K}from"./main-Dfa23GB-.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ee=P({__name:"MaterialList",setup(te){U.registerModules([Q,$]);const D=W,h=X(),V=n({title:"원자재검수관리"}),T=I([{title:"품질",disabled:!0,href:"#"},{title:"원자재검수관리",disabled:!1,href:"#"}]),a=B({receiptNo:"",materialCode:"",materialStatus:""}),u=n([]),x=t=>{const e=t.data;e&&h.push({path:"/qm/matmng",query:{receiptNo:e.receiptNo,matCode:e.materialCode,totalQty:String(e.receivedQty),inDate:e.receiptDate,materialName:e.materialName||"",createdBy:e.currentUserName||""}})};function s(...t){for(const e of t)if(e!=null&&e!=="")return e;return""}function w(t){if(!t)return"";try{const l=new Date(t);if(!isNaN(l.getTime()))return l.toISOString().slice(0,10)}catch{}const e=String(t);return/^\d{4}-\d{2}-\d{2}$/.test(e)?e:/^\d{8}$/.test(e)?`${e.slice(0,4)}-${e.slice(4,6)}-${e.slice(6)}`:e}const E=async()=>{try{const{data:t}=await g.get("http://localhost:3000/matmng");Array.isArray(t)&&t.length>0?u.value=t.map(e=>{const l=s(e.RECEIPT_NO,e.receiptNo,e.receipt_no,e.MCERT_NO),d=w(s(e.RECEIPT_DATE,e.receiptDate,e.receipt_dt,e.inDate)),c=s(e.SUPPLIER,e.supplier,e.SUPPLYER,e.supplyer),i=s(e.MAT_CODE,e.MATERIAL_CODE,e.materialCode,e.MATL_CD),f=Number(s(e.RECEIVED_QTY,e.receivedQty,e.RCV_QTY,e.qty,0))||0,p=s(e.TMP_STATUS,e.matStatus,e.STATUS,e.status);return{receiptNo:l,receiptDate:d,supplyer:c,materialCode:i,receivedQty:f,matStatus:p}}):u.value=[]}catch(t){console.error("원자재 데이터 로드 실패:",t)}},M=n([{headerName:"입고번호",field:"receiptNo",flex:1,resizable:!0},{headerName:"입고일자",field:"receiptDate",flex:1,resizable:!0},{headerName:"공급처",field:"supplyer",flex:1,resizable:!0},{headerName:"자재코드",field:"materialCode",flex:1,resizable:!0},{headerName:"입고수량",field:"receivedQty",flex:1,resizable:!0},{headerName:"상태",field:"matStatus",flex:1,resizable:!0}]),R=k(()=>{var c;const t=a.materialCode.trim().toLowerCase(),e=((c=a.materialStatus)==null?void 0:c.trim().toLowerCase())||"",l=a.receiptNo||"",d=u.value.filter(i=>{const f=!t||i.materialCode.toLowerCase().includes(t),p=!e||i.matStatus.toLowerCase().includes(e);let _=!0;return l&&(_=i.receiptDate===l),f&&p&&_});return console.log("필터링 결과:",{전체데이터:u.value.length,필터링후:d.length,검색조건:{materialCode:t,status:e,dateFilter:l}}),d}),A=n({defaultColDef:{flex:1,minWidth:100,resizable:!0},pagination:!0,paginationAutoPageSize:!0,paginationPageSizeSelector:!0});function z(){a.receiptNo="",a.materialCode="",a.materialStatus=""}function L(){console.log("검색 조건:",{입고일자:a.receiptNo,자재코드:a.materialCode,상태:a.materialStatus})}const C=n([]),O=async()=>{try{const t=await g.get("http://localhost:3000/matcommon");t.data&&t.data.length>0&&(C.value=[{label:"입고",value:""},...t.data.map(e=>({label:e.code_name,value:e.code_name}))])}catch(t){console.error("상태 옵션 로드 실패:",t)}};return q(()=>{O(),E()}),(t,e)=>(j(),F(Y,null,[r(G,{title:V.value.title,breadcrumbs:T.value},null,8,["title","breadcrumbs"]),r(J,null,{default:o(()=>[r(b,{class:"mb-4"},{default:o(()=>[r(m,{cols:"3"},{default:o(()=>[r(y,{label:"입고일자",modelValue:a.receiptNo,"onUpdate:modelValue":e[0]||(e[0]=l=>a.receiptNo=l),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),r(m,{cols:"3"},{default:o(()=>[r(y,{label:"자재코드",modelValue:a.materialCode,"onUpdate:modelValue":e[1]||(e[1]=l=>a.materialCode=l),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),r(m,{cols:"3"},{default:o(()=>[r(H,{label:"상태",modelValue:a.materialStatus,"onUpdate:modelValue":e[2]||(e[2]=l=>a.materialStatus=l),items:C.value,"item-title":"label","item-value":"value",dense:"",outlined:"",clearable:""},null,8,["modelValue","items"])]),_:1}),r(m,{cols:"3"},{default:o(()=>[r(v,{color:"primary",variant:"elevated",onClick:L},{default:o(()=>e[3]||(e[3]=[N("검색")])),_:1})]),_:1})]),_:1}),r(b,{justify:"end",class:"mb-4"},{default:o(()=>[r(v,{color:"error",variant:"elevated",onClick:z},{default:o(()=>e[4]||(e[4]=[N("초기화")])),_:1})]),_:1}),r(S(K),{rowData:R.value,columnDefs:M.value,theme:S(D),gridOptions:A.value,onRowClicked:x,style:{height:"400px"}},null,8,["rowData","columnDefs","theme","gridOptions"])]),_:1})],64))}}),se=Z(ee,[["__scopeId","data-v-04e362a7"]]);export{se as default};
