import{aK as T,O as m,y as u,_ as P,q as y,o as b,a as s,w as l,W as I,S as E,d,a0 as F,aI as U,aR as B,aG as D,F as g,s as O,C as R,aP as K,aQ as M,t as i,j as _,e as v,aF as $}from"./index-CGGVM91c.js";import{_ as z,a as W}from"./UiParentCard.vue_vue_type_script_setup_true_lang-DnD-5gIF.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"actions"},G={class:"bar"},H={class:"pct"},J={__name:"WorkStatus",setup(X){const r=T(),V={title:"작업 진행 현황"},h=[{title:"생산",disabled:!0,href:"#"},{title:"작업 진행 현황",disabled:!1,href:"#"}],N=[{code:"ALL",label:"전체"},{code:"CUT",label:"재단"},{code:"FAB",label:"가공"},{code:"POL",label:"연마"},{code:"PAI",label:"도장"},{code:"ASM",label:"조립"},{code:"DEFECT",label:"불량"}],o=m("ALL"),c=m(""),n=m(!1),w=()=>{},f=[{title:"공정명",value:"processName",width:120},{title:"지시번호",value:"issueNumber"},{title:"제품명",value:"productName"},{title:"상태",value:"state",width:110},{title:"진행률",value:"progress",sortable:!1,width:220},{title:"지시량",value:"targetQty",width:80},{title:"기생산",value:"producedQty",width:80},{title:"미생산",value:"remainingQty",width:80},{title:"불량량",value:"defectQty",width:80}],L=f.filter(e=>e.value!=="processName"),A=u(()=>o.value==="ALL"?f:L);function Q(e){return{CUT:1,FAB:2,POL:3,PAI:4,ASM:5}[e]||9}const p=u(()=>(r.flatRowsForStatus??[]).map(e=>({key:`${e.orderId}-${e.process}`,orderIdx:Q(e.process),process:e.process,processName:e.processName,issueNumber:e.issueNumber,productName:e.productName,state:e.state,progress:e.progress,targetQty:e.targetQty,producedQty:e.producedQty,remainingQty:e.remainingQty,defectQty:e.defectQty??0}))),C=u(()=>{const e={ALL:p.value.length};for(const a of p.value)e[a.process]=(e[a.process]||0)+1;return e}),k=u(()=>{const e=c.value.toLowerCase();return p.value.filter(a=>o.value==="ALL"?!0:o.value==="DEFECT"?a.defectQty>0:a.process===o.value).filter(a=>!e||a.issueNumber.toLowerCase().includes(e)||a.productName.toLowerCase().includes(e)).sort((a,t)=>a.orderIdx-t.orderIdx)});function x(e){return e==="RUN"?"진행중":e==="PAUSE"?"일시정지":e==="DONE"?"완료":"대기"}function S(e){return e==="RUN"?"primary":e==="DONE"?"success":e==="PAUSE"?"warning":"grey"}return P(()=>{var e;r.loadOrders({page:1,size:100}),(e=r.startTicker)==null||e.call(r)}),(e,a)=>(b(),y(g,null,[s(z,{title:V.title,breadcrumbs:h},null,8,["title"]),s(W,null,{default:l(()=>[s(I,{variant:"outlined"},{default:l(()=>[s(E,{class:"card-title"},{default:l(()=>[a[3]||(a[3]=d("span",null,"작업 진행 현황",-1)),d("div",q,[s(F,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=t=>c.value=t),modelModifiers:{trim:!0},placeholder:"지시번호/제품명 검색",density:"compact",variant:"outlined","hide-details":"",class:"search",onKeyup:U(w,["enter"])},null,8,["modelValue"]),s(B,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=t=>n.value=t),inset:"",color:"primary","hide-details":"",class:"ml-2",label:"지시번호 그룹"},null,8,["modelValue"])])]),_:1}),s(D,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=t=>o.value=t),density:"comfortable",class:"px-2"},{default:l(()=>[(b(),y(g,null,O(N,t=>s($,{key:t.code,value:t.code},{default:l(()=>[v(i(t.label)+" ",1),s(_,{size:"x-small",class:"ml-1",color:"primary",variant:"tonal"},{default:l(()=>[v(i(C.value[t.code]??0),1)]),_:2},1024)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),s(R),s(K,{headers:A.value,items:k.value,density:"compact","item-key":"key","items-per-page":10,"group-by":n.value?[{key:"issueNumber",order:"asc"}]:[],class:"no-hover"},{"item.state":l(({item:t})=>[s(_,{size:"small",color:S(t.state),variant:"tonal"},{default:l(()=>[v(i(x(t.state)),1)]),_:2},1032,["color"])]),"item.progress":l(({item:t})=>[d("div",G,[s(M,{"model-value":t.progress,height:"10",color:t.progress>=100?"success":"primary"},null,8,["model-value","color"]),d("span",H,i(t.progress)+"%",1)])]),_:2},1032,["headers","items","group-by"])]),_:1})]),_:1})],64))}},ae=j(J,[["__scopeId","data-v-fe6ca5a0"]]);export{ae as default};
