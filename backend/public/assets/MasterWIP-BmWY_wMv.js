import{_ as G,a as K}from"./UiParentCard.vue_vue_type_script_setup_true_lang-DnD-5gIF.js";import{O as i,P as Q,_ as H,$ as u,q as J,o as X,a as o,w as s,d as m,a0 as r,f,e as v,V as _,A as D,a1 as ee,b as d,a2 as R,F as ae}from"./index-CGGVM91c.js";import{B as te}from"./main-Dfa23GB-.js";import{_ as le}from"./NewModal-RG6-e5WE.js";import{d as oe}from"./theme-bootstrap-maRaUoWN.js";import{u as se}from"./auth-B63OrgMx.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={class:"d-flex align-center mb-4"},ue={class:"main-container"},de={class:"list-container"},re={class:"form-wrapper"},me={class:"add"},ce={__name:"MasterWIP",setup(pe){var T;const n=oe.useToast(),I=se(),x=ee,P=new Date().toISOString().split("T")[0],a=i({wipCode:"",wipName:"",writer:((T=I.user)==null?void 0:T.name)||"",date:P,size:"",unit:"",type:"",note:""}),w=i([]),U=i([{checkboxSelection:!0,width:50},{field:"재공품코드",editable:!0,width:130},{field:"재공품명",width:130,editable:!0},{field:"재공품유형",width:130,editable:!0},{field:"규격",width:110,editable:!0},{field:"단위",width:110,editable:!0},{field:"작성자",width:110,editable:!0},{field:"등록일자",width:110,editable:!0}]),S=i({title:"재공품 관리"}),A=Q([{title:"기준정보",disabled:!0,href:"#"},{title:"재공품 관리",disabled:!1,href:"#"}]),W=i([]),V=i([]),k=async()=>{const t=await u.get("http://localhost:3000/masterWIPUnit");W.value=t.data.map(e=>e.code_name)},z=async()=>{const t=await u.get("http://localhost:3000/masterWIPType");V.value=t.data.map(e=>e.code_name)},g=i(null),h=i(""),y=i([]),E=i([]),M=[{field:"그룹코드",headerName:"그룹코드",flex:1},{field:"규격",headerName:"규격",flex:1},{field:"사용유무",headerName:"사용유무",flex:1}],b=i([]),O=async()=>{const t=await u.get("http://localhost:3000/masterWIPModal");b.value=t.data.map(e=>({그룹코드:e.group_code,규격:e.code_name,사용유무:e.use_yn}))},$=async t=>{a.value.size=t.규격,n.info(`규격 [${t.규격}] 선택됨`,{position:"top-right"})},C=i(null),B=t=>{C.value=t.api};H(()=>{c(),k(),z(),O()});const c=async()=>{const t=await u.get("http://localhost:3000/masterWIPSelect");w.value=t.data.map(e=>({재공품코드:e.WIP_CODE,재공품명:e.WIP_NAME,재공품유형:e.WIP_TYPE,규격:e.WIP_SIZE,단위:e.WIP_UNIT,작성자:e.WIP_WRITER,등록일자:e.WIP_DATE.substring(0,10),비고:e.WIP_NOTE}))},F=async()=>{if(!a.value.type||!a.value.wipName||!a.value.size){n.warning("값을 올바르게 기재하십시오.",{position:"top-right",duration:1e3});return}if(a.value.wipCode){const t={WIP_NAME:a.value.wipName,WIP_TYPE:a.value.type,WIP_UNIT:a.value.unit,WIP_SIZE:a.value.size,WIP_DATE:a.value.date,WIP_NOTE:a.value.note,WIP_WRITER:a.value.writer,WIP_CODE:a.value.wipCode};await u.post("http://localhost:3000/masterWIPUpdate",t),n.success("재공품이 수정되었습니다.",{position:"top-right",duration:1e3})}else{const t={WIP_NAME:a.value.wipName,WIP_TYPE:a.value.type,WIP_UNIT:a.value.unit,WIP_SIZE:a.value.size,WIP_DATE:a.value.date,WIP_NOTE:a.value.note,WIP_WRITER:a.value.writer};await u.post("http://localhost:3000/masterWIPInsert",t),n.success("재공품이 등록되었습니다.",{position:"top-right",duration:1e3})}await c()},L=async()=>{const t=C.value.getSelectedRows();if(t.length===0){n.warning("삭제할 재공품을 선택하세요.",{position:"top-right",duration:1e3});return}if(!confirm(`${t.map(l=>l.재공품명).join(", ")}을 삭제하시겠습니까?`))return;const e=t.map(l=>l.재공품코드);console.log(e),await u.post("http://localhost:3000/masterWIPDelete",{WIP_CODE:e}),await c(),n.success(`${t.map(l=>l.재공품명)}(이)가 삭제되었습니다.`,{position:"top-right",duration:1e3})},Y=()=>{var t;a.value={wipCode:"",wipName:"",writer:((t=I.user)==null?void 0:t.name)||"",date:P,size:"",type:"",note:""},c()},Z=t=>{a.value.wipCode=t.data.재공품코드,a.value.wipName=t.data.재공품명,a.value.writer=t.data.작성자,a.value.date=t.data.등록일자,a.value.size=t.data.규격,a.value.unit=t.data.단위,a.value.type=t.data.재공품유형,a.value.note=t.data.비고},j=async(t,e,l)=>{var N;h.value=t,y.value=e,E.value=l,(N=g.value)==null||N.open()},p=i(""),q=async()=>{if(!p.value){n.warning("재공품이 입력되지 않았습니다",{position:"top-right",duration:1e3});return}const t={WIP_NAME:p.value},e=await u.post("http://localhost:3000/masterWIPSearch",t);w.value=e.data.map(l=>({재공품코드:l.WIP_CODE,재공품명:l.WIP_NAME,재공품유형:l.WIP_TYPE,규격:l.WIP_SIZE,단위:l.WIP_UNIT,작성자:l.WIP_WRITER,등록일자:l.WIP_DATE?l.WIP_DATE.substring(0,10):null,비고:l.WIP_NOTE})),n.success("검색이 완료되었습니다.",{position:"top-right",duration:1e3})};return(t,e)=>(X(),J(ae,null,[o(G,{title:S.value.title,breadcrumbs:A.value},null,8,["title","breadcrumbs"]),o(K,{title:"재공품 목록"},{default:s(()=>[m("div",ne,[o(r,{label:"재공품 검색",modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=l=>p.value=l),"hide-details":"",class:"mr-2",style:{"max-width":"280px"}},null,8,["modelValue"]),o(f,{color:"darkText",onClick:q},{default:s(()=>e[10]||(e[10]=[v("검색")])),_:1}),o(_,{justify:"end",class:"mr-3"},{default:s(()=>[o(f,{color:"error",class:"mr-1",onClick:L},{default:s(()=>e[11]||(e[11]=[v("삭제")])),_:1})]),_:1})]),m("div",ue,[m("div",de,[o(D(te),{rowData:w.value,columnDefs:U.value,theme:D(x),style:{height:"500px",width:"100%"},onCellValueChanged:t.onCellValueChanged,rowSelection:"single",onRowClicked:Z,onGridReady:B},null,8,["rowData","columnDefs","theme","onCellValueChanged"])]),m("div",re,[m("div",me,[o(_,{class:"mb-4"},{default:s(()=>[o(d,{cols:"6"},{default:s(()=>[o(r,{label:"재공품코드",modelValue:a.value.wipCode,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.wipCode=l),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(d,{cols:"6"},{default:s(()=>[o(r,{label:"재공품명",modelValue:a.value.wipName,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.wipName=l),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(d,{cols:"6"},{default:s(()=>[o(r,{label:"작성자",modelValue:a.value.writer,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.writer=l),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(d,{cols:"6"},{default:s(()=>[o(r,{label:"등록일자",modelValue:a.value.date,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.date=l),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(d,{cols:"6"},{default:s(()=>[o(R,{label:"단위",modelValue:a.value.unit,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.unit=l),items:W.value,dense:"",outlined:""},null,8,["modelValue","items"])]),_:1}),o(d,{cols:"6"},{default:s(()=>[o(R,{label:"재공품유형",modelValue:a.value.type,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.type=l),items:V.value,dense:"",outlined:""},null,8,["modelValue","items"])]),_:1}),o(d,{cols:"12"},{default:s(()=>[o(r,{label:"규격",modelValue:a.value.size,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.size=l),placeholder:"규격",dense:"",outlined:"",readonly:""},{"append-inner":s(()=>[m("i",{class:"fa-solid fa-magnifying-glass",style:{cursor:"pointer","font-size":"large","margin-right":"0.5rem"},onClick:e[7]||(e[7]=l=>j("재공품 규격 조회",b.value,M))})]),_:1},8,["modelValue"]),o(le,{ref_key:"modalRef",ref:g,title:h.value,rowData:y.value,colDefs:E.value,onConfirm:$},null,8,["title","rowData","colDefs"])]),_:1}),o(d,{cols:"12"},{default:s(()=>[o(r,{label:"비고",modelValue:a.value.note,"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.note=l),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(_,{justify:"center"},{default:s(()=>[o(f,{color:"error",class:"mr-3",onClick:Y},{default:s(()=>e[12]||(e[12]=[v("초기화")])),_:1}),o(f,{color:"primary",class:"mr-6",onClick:F},{default:s(()=>e[13]||(e[13]=[v("저장")])),_:1})]),_:1})]),_:1})])])])]),_:1})],64))}},Ve=ie(ce,[["__scopeId","data-v-83d7ce16"]]);export{Ve as default};
