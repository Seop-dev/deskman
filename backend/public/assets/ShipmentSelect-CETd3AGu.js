import{_ as U,a as L}from"./UiParentCard.vue_vue_type_script_setup_true_lang-DnD-5gIF.js";import{O as a,_ as B,P as W,$ as f,q as Y,o as $,a as o,w as i,d as R,a0 as S,f as m,e as v,V as Q,A as x,a1 as z,F}from"./index-CGGVM91c.js";import{B as G}from"./main-Dfa23GB-.js";import{_ as q}from"./NewModal-RG6-e5WE.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"d-flex align-center mb-4"},K={class:"main-container"},X={class:"list-container"},Z={__name:"ShipmentSelect",setup(ee){const b=z,d=a(""),u=a("");B(()=>{_()});const c=a([]),h=a([{headerCheckboxSelection:!0,checkboxSelection:!0,width:50},{field:"출하번호",editable:!0,flex:1},{field:"창고명",flex:1},{field:"LOT번호",flex:1},{field:"제품명",flex:1},{field:"출하수량",flex:1},{field:"운송사",flex:1,editable:!0},{field:"차량번호",flex:1,editable:!0},{field:"출하담당자",flex:1},{field:"출하예정일자",flex:1},{field:"출하일자",flex:1},{field:"출하상태",flex:1,editable:!0,cellStyle:l=>l.value==="대기"?{color:"green",fontWeight:"bold"}:l.value==="출하완료"?{color:"blue",fontWeight:"bold"}:null}]),C=a({title:"출하지시서"}),T=W([{title:"물류",disabled:!0,href:"#"},{title:"출하지시서",disabled:!1,href:"#"}]),y=l=>{console.log(l.value),console.log(c.value)},w=a([]),_=async()=>{const l=await f.get("http://localhost:3000/wrShip");w.value=l.data.map(e=>({출하번호:e.SHIP_NO,창고명:e.WR_NAME,주문번호:e.REQ_ID,LOT번호:e.PRD_LOT,제품명:e.PRD_NAME,출하수량:e.QTY,운송사:e.DELIVERY,차량번호:e.CAR_NO,출하담당자:e.SHIP_WRITER,출하예정일자:e.SHIP_ORDER_DATE?e.SHIP_ORDER_DATE.substring(0,10):null,출하일자:e.SHIP_DATE?e.SHIP_DATE.substring(0,10):null,출하상태:e.SHIP_STATUS})),c.value=w.value},E=a([]),V=a([]),r=a(null),A=l=>{r.value=l.api,console.log(r.value)},N=async()=>{const l=r.value.getSelectedRows();if(l.length===0){alert("출하할 제품을 선택하세요");return}const e=l.map(n=>({DELIVERY:n.운송사,CAR_NO:n.차량번호,SHIP_NO:n.출하번호})),t=l.map(n=>({QTY:n.출하수량,PRD_NAME:n.제품명,PRD_LOT:n.LOT번호})),s=await f.post("http://localhost:3000/wrShipUpdate",e),H=await f.post("http://localhost:3000/wrShipUpdate2",t);console.log(s),console.log(H),alert("출하 처리가 완료되었습니다."),_()},p=a(null),k=a(""),D=a([]),g=[{field:"거래처유형",headerName:"거래처유형",flex:1},{field:"거래처명",headerName:"거래처명",flex:1},{field:"거래담당자",headerName:"거래담당자",flex:1}],P=async l=>{if(r.value.getSelectedRows().length===0){alert("행을 선택해주세요");return}const t=await f.get("http://localhost:3000/wrDelivery");D.value=t.data.map(s=>({거래처유형:s.CUS_TYPE,거래처명:s.CUS_NAME,거래담당자:s.CUS_MANAGER})),console.log(t),k.value=l,E.value=c,V.value=h,p.value&&p.value.open()},I=async l=>{const e=r.value.getSelectedRows();console.log(l.거래처명),console.log(e[0].운송사);for(const t of e)t.운송사=l.거래처명;r.value.applyTransaction({update:e})},O=()=>{const l=d.value?new Date(d.value):null,e=u.value?new Date(u.value):null;c.value=w.value.filter(t=>{const s=new Date(t.출하예정일자);return l&&e?s>=l&&s<=e:l&&!e?s>=l:!l&&e?s<=e:!0})},M=async()=>{d.value="",u.value="",await _()};return(l,e)=>($(),Y(F,null,[o(U,{title:C.value.title,breadcrumbs:T.value},null,8,["title","breadcrumbs"]),o(L,{title:"출하지시서 조회"},{default:i(()=>[R("div",J,[o(S,{label:"출하 예정 일자",type:"date",modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),"hide-details":"",class:"mr-2",style:{"max-width":"180px"}},null,8,["modelValue"]),o(S,{label:"출하 예정 일자",type:"date",modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t),"hide-details":"",class:"mr-2",style:{"max-width":"180px"}},null,8,["modelValue"]),o(m,{color:"darkText",onClick:O},{default:i(()=>e[3]||(e[3]=[v("검색")])),_:1}),o(m,{color:"error",class:"ml-2",onClick:M},{default:i(()=>e[4]||(e[4]=[v("초기화")])),_:1}),o(Q,{justify:"end",class:"mr-3"},{default:i(()=>[o(m,{color:"warning",class:"mr-2",onClick:e[2]||(e[2]=t=>P("운송사 조회",D.value,g))},{default:i(()=>e[5]||(e[5]=[v("운송사")])),_:1}),o(q,{ref_key:"modalRef1",ref:p,title:l.modalTitle,rowData:D.value,colDefs:g,onConfirm:I},null,8,["title","rowData"]),o(m,{color:"primary",class:"mr-1",onClick:N},{default:i(()=>e[6]||(e[6]=[v("출하")])),_:1})]),_:1})]),R("div",K,[R("div",X,[o(x(G),{rowData:c.value,columnDefs:h.value,theme:x(b),style:{height:"500px",width:"100%"},onCellValueChanged:y,rowSelection:"multiple",rowMultiSelectWithClick:!0,onRowClicked:l.onRowClicked,onGridReady:A,pagination:!0,"pagination-page-size":"20"},null,8,["rowData","columnDefs","theme","onRowClicked"])])])]),_:1})],64))}},ne=j(Z,[["__scopeId","data-v-a6c7d98b"]]);export{ne as default};
