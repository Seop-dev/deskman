import{_ as ue,a as se}from"./UiParentCard.vue_vue_type_script_setup_true_lang-DnD-5gIF.js";import{B as de}from"./main-Dfa23GB-.js";import{O as g,P as _,aK as ne,y as D,am as ie,q as L,o as S,a as l,w as u,d as s,c as pe,k as E,V as G,b as f,a0 as y,f as H,e as d,aS as me,t as p,S as ce,T as fe,j as h,W as I,A as j,F as ye}from"./index-CGGVM91c.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Qe={class:"search-card"},Ae={class:"search-actions"},Ne={key:0,class:"mini-summary"},be={class:"summary-chips"},ge={class:"totals"},we={__name:"PerformanceCheck",setup(Ve){const K=g({title:"생산 실적 조회"}),J=_([{title:"생산",disabled:!0,href:"#"},{title:"생산 실적 조회",disabled:!1,href:"#"}]),n=g({issueNumber:"",productName:"",productType:"",startAt:"",endAt:""});function X(){n.value={issueNumber:"",productName:"",productType:"",startAt:"",endAt:""},m.value=null,N.value=[],F(),Q()}function w(t){return String(t).padStart(2,"0")}function a(t,e,r,c,A){return`${t}-${w(e)}-${w(r)}T${w(c)}:${w(A)}`}const x=["재단","가공","연마","도장","조립"],M=_([{issueNumber:"WO-20250811-2856",productCode:"P001",productName:"블랙 데스크",productType:"완제품",items:[{process:"재단",worker:"최윤수",startAt:a(2025,8,11,9,10),endAt:a(2025,8,11,10,20),orderQty:50,inputQty:50,defectQty:0,outputQty:50},{process:"가공",worker:"김성수",startAt:a(2025,8,11,10,30),endAt:a(2025,8,11,12,0),orderQty:50,inputQty:50,defectQty:2,outputQty:48},{process:"연마",worker:"정경준",startAt:a(2025,8,11,13,10),endAt:a(2025,8,11,14,0),orderQty:50,inputQty:48,defectQty:1,outputQty:47},{process:"도장",worker:"김태완",startAt:a(2025,8,11,14,20),endAt:a(2025,8,11,16,10),orderQty:50,inputQty:47,defectQty:1,outputQty:46},{process:"조립",worker:"이동현",startAt:a(2025,8,11,16,30),endAt:a(2025,8,11,17,10),orderQty:50,inputQty:46,defectQty:0,outputQty:46}]},{issueNumber:"WO-20250705-4112",productCode:"P001",productName:"블랙 데스크",productType:"완제품",items:[{process:"재단",worker:"최윤수",startAt:a(2025,7,5,9,0),endAt:a(2025,7,5,10,0),orderQty:120,inputQty:120,defectQty:0,outputQty:120},{process:"가공",worker:"김성수",startAt:a(2025,7,5,10,10),endAt:a(2025,7,5,12,30),orderQty:120,inputQty:120,defectQty:5,outputQty:115},{process:"연마",worker:"정경준",startAt:a(2025,7,5,13,0),endAt:a(2025,7,5,13,50),orderQty:120,inputQty:115,defectQty:1,outputQty:114},{process:"도장",worker:"김태완",startAt:a(2025,7,5,14,10),endAt:a(2025,7,5,16,30),orderQty:120,inputQty:114,defectQty:2,outputQty:112},{process:"조립",worker:"이동현",startAt:a(2025,7,5,16,40),endAt:a(2025,7,5,17,20),orderQty:120,inputQty:112,defectQty:0,outputQty:112}]},{issueNumber:"WO-20250621-1023",productCode:"P002",productName:"화이트 데스크",productType:"반제품",items:[{process:"재단",worker:"최은수",startAt:a(2025,6,21,9,10),endAt:a(2025,6,21,10,0),orderQty:200,inputQty:200,defectQty:0,outputQty:200},{process:"가공",worker:"김성수",startAt:a(2025,6,21,10,10),endAt:a(2025,6,21,12,40),orderQty:200,inputQty:200,defectQty:4,outputQty:196},{process:"연마",worker:"정경준",startAt:a(2025,6,21,13,20),endAt:a(2025,6,21,14,10),orderQty:200,inputQty:196,defectQty:2,outputQty:194},{process:"도장",worker:"김태완",startAt:a(2025,6,21,14,30),endAt:a(2025,6,21,15,50),orderQty:200,inputQty:194,defectQty:1,outputQty:193}]}]),m=g(null),N=g([]),o=g({issueNumber:"",orderDate:"",contact:"",productCode:"",dueDate:"",targetQty:0,productName:""});function F(){o.value={issueNumber:"",orderDate:"",contact:"",productCode:"",dueDate:"",targetQty:0,productName:""}}function P(t){const e=n.value.startAt?new Date(n.value.startAt).getTime():null,r=n.value.endAt?new Date(n.value.endAt).getTime():null,c=new Date(t).getTime();return!(e&&c<e||r&&c>r)}const Y=ne();function Z(){var B,O,U,q,R,W;let e=Y.findPerformance(n.value);if(!e){const i=n.value.issueNumber.trim(),v=n.value.productName.trim(),k=n.value.productType;i&&(e=M.value.find(C=>C.issueNumber.includes(i))),!e&&(v||k)&&(e=M.value.find(C=>(!v||C.productName.includes(v))&&(!k||C.productType===k)))}if(!e){m.value=null,N.value=[],F(),alert("검색결과가 없습니다."),Q();return}m.value=e;const c=[...e.items].sort((i,v)=>x.indexOf(i.process)-x.indexOf(v.process)).filter(i=>!n.value.startAt&&!n.value.endAt||P(i.startAt)||P(i.endAt));N.value=c.map((i,v)=>({seq:v+1,...i,startText:(i.startAt||"").replace("T"," "),endText:(i.endAt||"").replace("T"," "),durationMin:ae(i.startAt,i.endAt)}));const A=((O=(B=e.items)==null?void 0:B[0])==null?void 0:O.startAt)??"",T=((q=(U=e.items)==null?void 0:U[e.items.length-1])==null?void 0:q.endAt)??"";o.value.issueNumber=e.issueNumber,o.value.orderDate=(A||"").split("T")[0]||"",o.value.contact="홍길동",o.value.productCode=e.productCode,o.value.dueDate=(T||"").split("T")[0]||"",o.value.targetQty=((W=(R=e.items)==null?void 0:R[0])==null?void 0:W.orderQty)??0,o.value.productName=e.productName,Q()}function ee(t){return t==="반제품"?["재단","가공","연마","도장"]:["재단","가공","연마","도장","조립"]}const $=D(()=>{const t=m.value;if(!t)return 0;const r=ee(t.productType).map(c=>{var A;return((A=t.items.find(T=>T.process===c))==null?void 0:A.outputQty)??0});return r.length?Math.max(0,Math.min(...r)):0});function te(){}const b=D(()=>{const t={orderQty:0,inputQty:0,defectQty:0,outputQty:0,durationMin:0};return N.value.forEach(e=>{t.orderQty+=e.orderQty||0,t.inputQty+=e.inputQty||0,t.defectQty+=e.defectQty||0,t.outputQty+=e.outputQty||0,t.durationMin+=e.durationMin||0}),t}),le=D(()=>z(b.value.durationMin));function ae(t,e){return Math.max(0,Math.round((new Date(e)-new Date(t))/6e4))}function z(t){const e=Math.floor(t/60),r=t%60;return`${String(e).padStart(2,"0")}:${String(r).padStart(2,"0")}`}let V;function re(t){V=t.api,Q()}function Q(){V==null||V.sizeColumnsToFit()}const oe=ie([{headerName:"공정명",field:"process",width:110,cellClass:"cell-ellipsis"},{headerName:"작업자",field:"worker",width:100,cellClass:"cell-ellipsis"},{headerName:"시작일시",field:"startText",minWidth:160,flex:1,cellClass:"cell-ellipsis"},{headerName:"종료일시",field:"endText",minWidth:160,flex:1,cellClass:"cell-ellipsis"},{headerName:"소요시간(시:분)",field:"durationMin",width:130,valueFormatter:t=>t.value==null?"":z(t.value),cellClass:"ag-right-aligned-cell"},{headerName:"지시량",field:"orderQty",width:100,cellClass:"ag-right-aligned-cell"},{headerName:"투입량",field:"inputQty",width:100,cellClass:"ag-right-aligned-cell"},{headerName:"불량량",field:"defectQty",width:100,cellClass:"ag-right-aligned-cell"},{headerName:"생산량",field:"outputQty",width:100,cellClass:"ag-right-aligned-cell"}]);return(t,e)=>(S(),L(ye,null,[l(ue,{title:K.value.title,breadcrumbs:J.value},null,8,["title","breadcrumbs"]),l(se,null,{default:u(()=>[s("div",Qe,[e[13]||(e[13]=s("h5",{class:"pane-title"},"생산실적조회",-1)),l(G,{class:"mt-2",dense:""},{default:u(()=>[l(f,{cols:"12",md:"4"},{default:u(()=>[l(y,{label:"지시번호",modelValue:n.value.issueNumber,"onUpdate:modelValue":e[0]||(e[0]=r=>n.value.issueNumber=r),modelModifiers:{trim:!0},dense:"",outlined:"",placeholder:"예) WO-20250811-2856"},null,8,["modelValue"])]),_:1})]),_:1}),s("div",Ae,[l(H,{variant:"flat",color:"error",onClick:X},{default:u(()=>e[8]||(e[8]=[d("초기화")])),_:1}),l(H,{class:"ml-2",color:"darkText",onClick:Z},{default:u(()=>e[9]||(e[9]=[d("검색")])),_:1})]),m.value?(S(),L("div",Ne,[l(me,{type:"info",variant:"tonal",density:"compact"},{default:u(()=>[e[10]||(e[10]=d(" 지시번호: ")),s("b",null,p(m.value.issueNumber),1),e[11]||(e[11]=s("span",{class:"divider"},"|",-1)),d(" 제품명: "+p(m.value.productName)+" ",1),e[12]||(e[12]=s("span",{class:"divider"},"|",-1)),d(" 제품유형: "+p(m.value.productType),1)]),_:1})])):E("",!0)]),m.value?(S(),pe(I,{key:0,class:"info-card mt-4",variant:"outlined"},{default:u(()=>[l(ce,{class:"py-2"},{default:u(()=>e[14]||(e[14]=[d("기본정보")])),_:1}),l(fe,null,{default:u(()=>[l(G,{class:"mb-2",dense:""},{default:u(()=>[l(f,{cols:"12",md:"4"},{default:u(()=>[l(y,{label:"지시번호",modelValue:o.value.issueNumber,"onUpdate:modelValue":e[1]||(e[1]=r=>o.value.issueNumber=r),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),l(f,{cols:"12",md:"4"},{default:u(()=>[l(y,{label:"지시일자",modelValue:o.value.orderDate,"onUpdate:modelValue":e[2]||(e[2]=r=>o.value.orderDate=r),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),l(f,{cols:"12",md:"4"},{default:u(()=>[l(y,{label:"작성자",modelValue:o.value.contact,"onUpdate:modelValue":e[3]||(e[3]=r=>o.value.contact=r),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),l(f,{cols:"12",md:"4"},{default:u(()=>[l(y,{label:"제품코드",modelValue:o.value.productCode,"onUpdate:modelValue":e[4]||(e[4]=r=>o.value.productCode=r),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),l(f,{cols:"12",md:"4"},{default:u(()=>[l(y,{label:"납기일자",modelValue:o.value.dueDate,"onUpdate:modelValue":e[5]||(e[5]=r=>o.value.dueDate=r),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),l(f,{cols:"12",md:"4"},{default:u(()=>[l(y,{label:"목표수량",modelValue:o.value.targetQty,"onUpdate:modelValue":e[6]||(e[6]=r=>o.value.targetQty=r),modelModifiers:{number:!0},type:"number",min:"0",step:"1",dense:"",outlined:"",onInput:te},null,8,["modelValue"])]),_:1}),l(f,{cols:"12",md:"4"},{default:u(()=>[l(y,{label:"제품명칭",modelValue:o.value.productName,"onUpdate:modelValue":e[7]||(e[7]=r=>o.value.productName=r),readonly:"",dense:"",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),s("div",be,[l(h,{size:"small",variant:"tonal"},{default:u(()=>[d("목표 "+p((o.value.targetQty??0).toLocaleString()),1)]),_:1}),l(h,{size:"small",color:"primary",variant:"tonal"},{default:u(()=>[d("기생산 "+p($.value.toLocaleString()),1)]),_:1}),l(h,{size:"small",color:"error",variant:"tonal"},{default:u(()=>[d(" 미생산 "+p(Math.max((o.value.targetQty||0)-$.value,0).toLocaleString()),1)]),_:1})])]),_:1})]),_:1})):E("",!0),e[20]||(e[20]=s("div",{class:"section-head mt-4"},[s("h5",{class:"pane-title"},"조회결과")],-1)),l(j(de),{class:"ag-theme-quartz ag-no-wrap",rowData:N.value,columnDefs:j(oe),pagination:!0,paginationPageSize:10,domLayout:"autoHeight",onGridReady:re,onFirstDataRendered:Q,onGridSizeChanged:Q},null,8,["rowData","columnDefs"]),l(I,{class:"mt-3 pa-3",variant:"outlined"},{default:u(()=>[s("div",ge,[s("div",null,[e[15]||(e[15]=d(" 소요시간 합계: ")),s("b",null,p(le.value),1)]),s("div",null,[e[16]||(e[16]=d(" 지시량 합계: ")),s("b",null,p(b.value.orderQty),1)]),s("div",null,[e[17]||(e[17]=d(" 투입량 합계: ")),s("b",null,p(b.value.inputQty),1)]),s("div",null,[e[18]||(e[18]=d(" 불량량 합계: ")),s("b",null,p(b.value.defectQty),1)]),s("div",null,[e[19]||(e[19]=d(" 생산량 합계: ")),s("b",null,p(b.value.outputQty),1)])])]),_:1})]),_:1})],64))}},Se=ve(we,[["__scopeId","data-v-aa43d2e5"]]);export{Se as default};
