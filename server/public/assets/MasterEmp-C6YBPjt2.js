import{_ as j,a as q}from"./UiParentCard.vue_vue_type_script_setup_true_lang-DnD-5gIF.js";import{O as d,P as K,_ as Q,$ as r,q as J,o as W,a as o,w as s,d as u,a0 as n,f,e as v,V as w,A as b,a1 as X,b as i,a2 as Y,a3 as Z,a4 as y,F as ee}from"./index-CGGVM91c.js";import{B as ae}from"./main-Dfa23GB-.js";import{_ as le}from"./NewModal-RG6-e5WE.js";import{d as te}from"./theme-bootstrap-maRaUoWN.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se={class:"d-flex align-center mb-4"},de={class:"main-container"},ue={class:"list-container"},ne={class:"form-wrapper"},ie={class:"add"},re={class:"radioDiv"},me={__name:"MasterEmp",setup(pe){const m=te.useToast(),c=d(""),R=d({title:"사원 관리"}),U=K([{title:"기준정보",disabled:!0,href:"#"},{title:"사원 관리",disabled:!1,href:"#"}]),x=X,a=d({empNo:"",phone:"",empName:"",hireDate:"",auth:"",dept:"",addr:"",status:"",endDate:""});Q(()=>{p(),H(),F()});const E=d([]),C=d([{checkboxSelection:!0,width:50},{field:"사원번호",width:150},{field:"사원명",width:140},{field:"부서",width:130},{field:"직급",width:130},{field:"재직상태",width:130},{field:"연락처",width:150},{field:"이메일",width:150},{field:"주소",width:200},{field:"입사일자",width:110},{field:"퇴사일자",width:110}]),p=async()=>{const t=await r.get("http://localhost:3000/masterEmp");E.value=t.data.map(e=>({사원번호:e.EMP_NO,사원명:e.EMP_NAME,입사일자:e.EMP_HDATE?e.EMP_HDATE.substring(0,10):null,주소:e.ADDR,연락처:e.PHONE,이메일:e.EMAIL,부서:e.DEPT_NAME,직급:e.AUTH,퇴사일자:e.EMP_EDATE?e.EMP_EDATE.substring(0,10):null,재직상태:e.EMP_STATUS}))},M=d([]),H=async()=>{try{const t=await r.get("http://localhost:3000/commonAuth");M.value=t.data.map(e=>e.code_name)}catch(t){console.error("공통코드 데이터를 불러오는 데 실패했습니다:",t)}},k=async()=>{if(!c.value){m.warning("사원이 입력되지 않았습니다",{position:"top-right",duration:1e3});return}const t={EMP_NAME:c.value},e=await r.post("http://localhost:3000/masterEmpName",t);E.value=e.data.map(l=>({사원번호:l.EMP_NO,사원명:l.EMP_NAME,입사일자:l.EMP_HDATE?l.EMP_HDATE.substring(0,10):null,주소:l.ADDR,연락처:l.PHONE,이메일:l.EMAIL,부서:l.DEPT_NAME,직급:l.AUTH,퇴사일자:l.EMP_EDATE?l.EMP_EDATE.substring(0,10):null,재직상태:l.EMP_STATUS})),m.success("검색이 완료되었습니다.",{position:"top-right",duration:1e3})},S=async()=>{var t,e,l,T;if(a.value.empNo){const h={EMP_NAME:a.value.empName,PHONE:a.value.phone,EMAIL:a.value.email,DEPT_NAME:a.value.dept,AUTH:a.value.auth,ADDR:a.value.addr,EMP_STATUS:a.value.status,EMP_HDATE:((t=a.value.hireDate)==null?void 0:t.trim())||null,EMP_EDATE:((e=a.value.endDate)==null?void 0:e.trim())||null,EMP_NO:a.value.empNo},V=await r.put("http://localhost:3000/masterEmpUpdate",h);console.log(V.config.data),m.success(`${a.value.empName}의 정보가 수정되었습니다`,{position:"top-right",duration:1e3}),p()}else{if(a.value.endDate){m.error("퇴직이 선택되어있습니다.");return}const h={EMP_NAME:a.value.empName,PHONE:a.value.phone,EMAIL:a.value.email,DEPT_NAME:a.value.dept,AUTH:a.value.auth,ADDR:a.value.addr,EMP_STATUS:a.value.status,EMP_HDATE:((l=a.value.hireDate)==null?void 0:l.trim())||null,EMP_EDATE:((T=a.value.endDate)==null?void 0:T.trim())||null},V=await r.post("http://localhost:3000/masterEmpInsert",h);console.log(V.config.data),p()}};let D=null;const O=t=>{D=t.api},$=async()=>{if(!D)return;const t=D.getSelectedRows();if(t.length===0){m.warning("삭제할 사원을 선택하세요",{position:"top-right",duration:1e3});return}const e={empNo:t[0].사원번호};console.log(e);const l=await r.delete("http://localhost:3000/masterEmpDelete",{data:e});m.success(`${a.value.empName}(이)가 삭제되었습니다.`),console.log(l),p()},B=()=>{a.value={empName:"",hireDate:"",empNo:"",email:"",phone:"",auth:"",dept:"",addr:"",status:"재직"},p()},I=t=>{console.log(t.data),a.value.empNo=t.data.사원번호,a.value.empName=t.data.사원명,a.value.hireDate=t.data.입사일자,a.value.addr=t.data.주소,a.value.dept=t.data.부서,a.value.auth=t.data.직급,a.value.email=t.data.이메일,a.value.status=t.data.재직상태,a.value.phone=t.data.연락처,a.value.endDate=t.data.퇴사일자},_=d(null),A=d(""),N=d([]),g=d([]),L=[{field:"그룹코드",headerName:"그룹코드",flex:1},{field:"부서명",headerName:"부서명",flex:1}],P=d([]),F=async()=>{const t=await r.get("http://localhost:3000/commonDept");P.value=t.data.map(e=>({그룹코드:e.group_code,부서명:e.code_name})),console.log(t)},z=async(t,e,l)=>{A.value=t,N.value=e,g.value=l,_.value&&_.value.open()},G=async t=>{a.value.dept=t.부서명};return(t,e)=>(W(),J(ee,null,[o(j,{title:R.value.title,breadcrumbs:U.value},null,8,["title","breadcrumbs"]),o(q,{title:"사원 목록"},{default:s(()=>[u("div",se,[o(n,{label:"사원 검색",modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=l=>c.value=l),"hide-details":"",class:"mr-2",style:{"max-width":"280px"}},null,8,["modelValue"]),o(f,{color:"darkText",onClick:k},{default:s(()=>e[12]||(e[12]=[v("검색")])),_:1}),o(w,{justify:"end",class:"mr-3"},{default:s(()=>[o(f,{color:"error",class:"mr-1",onClick:$},{default:s(()=>e[13]||(e[13]=[v("삭제")])),_:1})]),_:1})]),u("div",de,[u("div",ue,[o(b(ae),{rowData:E.value,columnDefs:C.value,theme:b(x),style:{height:"500px",width:"100%"},rowSelection:"single",onRowClicked:I,onGridReady:O},null,8,["rowData","columnDefs","theme"])]),u("div",ne,[u("div",ie,[o(w,{class:"mb-4"},{default:s(()=>[o(i,{cols:"6"},{default:s(()=>[o(n,{label:"사원번호",modelValue:a.value.empNo,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.empNo=l),readonly:"true",outlined:""},null,8,["modelValue"])]),_:1}),o(i,{cols:"6"},{default:s(()=>[o(n,{label:"사원명",modelValue:a.value.empName,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.empName=l),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(i,{cols:"6"},{default:s(()=>[o(n,{label:"연락처",modelValue:a.value.phone,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.phone=l),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(i,{cols:"6"},{default:s(()=>[o(n,{label:"이메일",modelValue:a.value.email,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.email=l),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(i,{cols:"6"},{default:s(()=>[o(n,{label:"부서명",modelValue:a.value.dept,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.dept=l),placeholder:"부서명",dense:"",outlined:"",readonly:""},{"append-inner":s(()=>[u("i",{class:"fa-solid fa-magnifying-glass",style:{cursor:"pointer","font-size":"large","margin-right":"0.5rem"},onClick:e[5]||(e[5]=l=>z("부서 조회",P.value,L))})]),_:1},8,["modelValue"]),o(le,{ref_key:"modalRef",ref:_,title:A.value,rowData:N.value,colDefs:g.value,onConfirm:G},null,8,["title","rowData","colDefs"])]),_:1}),o(i,{cols:"6"},{default:s(()=>[o(Y,{label:"직급",modelValue:a.value.auth,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.auth=l),items:M.value,dense:"",outlined:""},null,8,["modelValue","items"])]),_:1}),o(i,{cols:"12"},{default:s(()=>[o(n,{label:"주소",modelValue:a.value.addr,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.addr=l),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),u("div",re,[e[14]||(e[14]=u("span",{class:"mr-4"},"재직 상태 :",-1)),o(Z,{modelValue:a.value.status,"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.status=l),inline:"","hide-details":""},{default:s(()=>[o(y,{label:"재직",value:"재직"}),o(y,{label:"퇴직",value:"퇴직"})]),_:1},8,["modelValue"])]),o(i,{cols:"4"},{default:s(()=>[o(n,{label:"입사일자",modelValue:a.value.hireDate,"onUpdate:modelValue":e[10]||(e[10]=l=>a.value.hireDate=l),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(i,{cols:"4"},{default:s(()=>[o(n,{label:"퇴사일자",modelValue:a.value.endDate,"onUpdate:modelValue":e[11]||(e[11]=l=>a.value.endDate=l),type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(w,{justify:"center"},{default:s(()=>[o(f,{color:"error",class:"mr-3",onClick:B},{default:s(()=>e[15]||(e[15]=[v("초기화")])),_:1}),o(f,{color:"primary",class:"mr-6",onClick:S},{default:s(()=>e[16]||(e[16]=[v("저장")])),_:1})]),_:1})]),_:1})]),e[17]||(e[17]=u("br",null,null,-1))])])]),_:1})],64))}},he=oe(me,[["__scopeId","data-v-efd5f03e"]]);export{he as default};
