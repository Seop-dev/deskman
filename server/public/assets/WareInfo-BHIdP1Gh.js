import{_ as ee,a as le}from"./UiParentCard.vue_vue_type_script_setup_true_lang-DnD-5gIF.js";import{O as d,a5 as G,c as oe,o as Y,w as a,a as o,W as te,S as ae,e as u,t as se,Z as j,f as c,T as ne,A,a1 as q,G as re,Y as de,$ as m,_ as ue,P as ie,q as ce,d as D,V as S,b as w,a0 as R,F as fe}from"./index-CGGVM91c.js";import{B as L}from"./main-Dfa23GB-.js";import{d as Q}from"./theme-bootstrap-maRaUoWN.js";import{_ as me}from"./NewModal-RG6-e5WE.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ve={__name:"WrModal",props:{title:String,rowData:Array,colDefs:Array},emits:["confirm","deleted","update"],setup(T,{expose:i,emit:I}){const l=Q.useToast(),g=q,C=d(!1),b=T;let y=null;const E=s=>{y=s.api},x=async()=>{const s=y.getSelectedRows();if(console.log(s),s.length===0){alert("삭제할 창고를 선택하세요",{position:"top-right",duration:1e3});return}const r={WR_NO:s[0].창고번호};if(window.confirm(`${s[0].창고명} 를 삭제하시겠습니까?`))try{p.value=p.value.filter(f=>f.창고번호!==s[0].창고번호),await m.post("http://localhost:3000/wrModalDelete",r),l.success("삭제 완료",{position:"top-right",duration:1e3}),W("deleted")}catch{l.error("창고에 데이터가 있어서 삭제하지 못했습니다.")}else console.log("삭제취소")},p=d([]),_=d([]),v=d(null);G(()=>b.rowData,s=>{p.value=s},{immediate:!0}),G(()=>b.colDefs,s=>{_.value=s},{immediate:!0});const h=()=>{C.value=!0},N=()=>{C.value=!1},M=()=>{const s={};p.value.push(s)},k=async()=>{const s=y.getSelectedRows();if(s.length===0){l.error("추가할 행을 선택하세요");return}const r={WR_ADDR:s[0].창고주소,WR_NAME:s[0].창고명},f=await m.post("http://localhost:3000/wrModalInsert",r);console.log(f.config.data)};function V(s){v.value=s.data,console.log(v.value)}const W=I,O=()=>{v.value&&W("confirm",v.value),N()};return i({open:h}),(s,r)=>(Y(),oe(de,{modelValue:C.value,"onUpdate:modelValue":r[0]||(r[0]=f=>C.value=f),"max-width":"800",scrollable:"true"},{default:a(()=>[o(te,null,{default:a(()=>[o(ae,{class:"headline"},{default:a(()=>[u(se(T.title),1)]),_:1}),o(j,{class:"justify-end"},{default:a(()=>[o(c,{color:"darkText",variant:"flat",class:"mr-1",onClick:M},{default:a(()=>r[1]||(r[1]=[u("추가")])),_:1}),o(c,{color:"primary",variant:"flat",class:"mr-1",onClick:k},{default:a(()=>r[2]||(r[2]=[u("저장")])),_:1}),o(c,{color:"error",variant:"flat",class:"mr-4",onClick:x},{default:a(()=>r[3]||(r[3]=[u("삭제")])),_:1})]),_:1}),o(ne,null,{default:a(()=>[o(A(L),{rowData:p.value,columnDefs:_.value,theme:A(g),rowSelection:"single",onRowClicked:V,style:{height:"400px",width:"100%"},pagination:!0,"pagination-page-size":10,onGridReady:E},null,8,["rowData","columnDefs","theme"])]),_:1}),o(j,null,{default:a(()=>[o(re),o(c,{color:"primary",text:"",onClick:O},{default:a(()=>r[4]||(r[4]=[u("확인")])),_:1}),o(c,{color:"error",text:"",onClick:N},{default:a(()=>r[5]||(r[5]=[u("취소")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},we={class:"d-flex align-center mb-4"},Re={class:"main-container"},ge={class:"list-container"},Ce={class:"form-wrapper"},_e={class:"add"},De={class:"d-flex align-center mb-4"},ye={__name:"WareInfo",setup(T){const i=Q.useToast(),I=q;ue(()=>{V(),Z()});const l=d({wrNo:"",wrName:"",wrAddr:"",secCode:"",dtNo:"",code:"",type:""}),g=d([]),C=d([{headerCheckboxSelection:!0,checkboxSelection:!0,width:50},{field:"구역번호",flex:1,editable:!0},{field:"섹션코드",flex:1,editable:!0},{field:"품목코드",flex:1,editable:!0},{field:"품목유형",flex:1,editable:!0}]),b=d({title:"창고 관리"}),y=ie([{title:"물류",disabled:!0,href:"#"},{title:"창고 관리",disabled:!1,href:"#"}]),E=t=>{console.log(t.value),console.log(g.value)};let x=null;const p=t=>{x=t.api},_=d(null),v=d(""),h=d([]),N=d([]),M=[{headerCheckboxSelection:!0,checkboxSelection:!0,flex:.5},{field:"창고번호",headerName:"창고번호",readonly:"true",flex:1},{field:"창고명",headerName:"창고명",flex:1,editable:!0},{field:"창고주소",headerName:"창고주소",flex:3,editable:!0}],k=d([]),V=async()=>{const t=await m.get("http://localhost:3000/wrModalSelect");k.value=t.data.map(e=>({창고번호:e.WR_NO,창고명:e.WR_NAME,창고주소:e.WR_ADDR}))},W=(t,e,n)=>{v.value=t,h.value=e,N.value=n,_.value&&_.value.open()},O=async t=>{console.log(t),l.value.wrNo=t.창고번호,l.value.wrName=t.창고명,l.value.wrAddr=t.창고주소,s()};async function s(){const t={WR_NO:l.value.wrNo},e=await m.post("http://localhost:3000/wrSelect",t);g.value=e.data.map(n=>({구역번호:n.WR_AREANO,섹션코드:n.WR_SECTION,품목코드:n.WR_PRD_ID,품목유형:n.WR_TYPE}))}const r=d(null),f=d(""),$=d([]),P=d([]),B=[{headerCheckboxSelection:!0,checkboxSelection:!0,flex:.5},{field:"품목코드",headerName:"품목코드",flex:1,editable:!0},{field:"품목유형",headerName:"품목유형",flex:1,editable:!0}],U=d([]),z=(t,e,n)=>{f.value=t,$.value=e,P.value=n,r.value&&r.value.open()},Z=async()=>{const t=await m.get("http://localhost:3000/InfoModal");U.value=t.data.map(e=>({품목코드:e.code,품목유형:e.code_name}))},H=async t=>{console.log(t),l.value.code=t.품목코드,l.value.type=t.품목유형},J=t=>{l.value.secCode=t.data.섹션코드,l.value.dtNo=t.data.구역번호,l.value.code=t.data.품목코드,l.value.type=t.data.품목유형},F=()=>{l.value.secCode="",l.value.dtNo="",l.value.code="",l.value.type=""},K=async()=>{try{const t=g.value.some(e=>e.섹션코드===l.value.secCode);if(!l.value.secCode&&t){i.warning("이미 등록된 섹션코드입니다.",{position:"top-right",duration:1e3});return}if(!l.value.type||!l.value.dtNo){i.warning("구역번호와 유형을 입력하세요.",{position:"top-right",duration:1e3});return}if(l.value.secCode){const e={WR_AREANO:l.value.dtNo.toUpperCase(),WR_SECTION:l.value.secCode,WR_PRD_ID:l.value.code,WR_TYPE:l.value.type,WR_NO:l.value.wrNo};await m.post("http://localhost:3000/wrInfoUpdate",e),i.success("창고가 수정되었습니다.",{position:"top-right",duration:1e3}),await s()}else{const e={WR_AREANO:l.value.dtNo.toUpperCase(),WR_PRD_ID:l.value.code,WR_TYPE:l.value.type,WR_NO:l.value.wrNo};await m.post("http://localhost:3000/wrInfoInsert",e),i.success("구역이 추가되었습니다.",{position:"top-right",duration:1e3}),await s()}}catch(t){console.error(t),i.error("저장 중 오류가 발생했습니다.",{position:"top-right",duration:1e3})}},X=async()=>{const t=x.getSelectedRows();if(console.log(t),t.length===0){i.warning("삭제할 구역을 선택하세요",{position:"top-right",duration:1e3});return}const e={WR_SECTION:t[0].섹션코드};confirm("구역을 삭제하시겠습니까?")?(await m.post("http://localhost:3000/wrDelete",e),i.success("삭제 완료",{position:"top-right",duration:1e3}),await s(),F()):console.log("삭제취소")};return(t,e)=>(Y(),ce(fe,null,[o(ee,{title:b.value.title,breadcrumbs:y.value},null,8,["title","breadcrumbs"]),o(le,{title:"창고 조회"},{default:a(()=>[D("div",we,[o(S,{justify:"start"},{default:a(()=>[o(c,{color:"warning",class:"ml-4",onClick:e[0]||(e[0]=n=>W("창고 목록",k.value,M)),style:{"margin-bottom":"2rem"}},{default:a(()=>e[10]||(e[10]=[u("창고 등록 및 조회 ")])),_:1}),o(ve,{ref_key:"modalRef",ref:_,title:v.value,rowData:h.value,colDefs:N.value,onConfirm:O,onDeleted:V,onUpdate:V},null,8,["title","rowData","colDefs"])]),_:1}),o(S,{justify:"end",class:"mr-3"},{default:a(()=>[o(c,{color:"error",class:"mr-1",onClick:X},{default:a(()=>e[11]||(e[11]=[u("삭제")])),_:1})]),_:1})]),D("div",Re,[D("div",ge,[o(A(L),{rowData:g.value,columnDefs:C.value,theme:A(I),style:{height:"500px",width:"100%"},onCellValueChanged:E,rowSelection:"single",rowMultiSelectWithClick:!0,onRowClicked:J,onGridReady:p,pagination:!0,"pagination-page-size":20},null,8,["rowData","columnDefs","theme"])]),D("div",Ce,[D("div",_e,[o(S,{class:"mb-4"},{default:a(()=>[o(w,{cols:"6"},{default:a(()=>[o(R,{label:"창고번호",modelValue:l.value.wrNo,"onUpdate:modelValue":e[1]||(e[1]=n=>l.value.wrNo=n),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(w,{cols:"6"},{default:a(()=>[o(R,{label:"창고 이름",modelValue:l.value.wrName,"onUpdate:modelValue":e[2]||(e[2]=n=>l.value.wrName=n),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(w,{cols:"12"},{default:a(()=>[o(R,{label:"창고 주소",modelValue:l.value.wrAddr,"onUpdate:modelValue":e[3]||(e[3]=n=>l.value.wrAddr=n),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(w,{cols:"6"},{default:a(()=>[o(R,{label:"구역번호",modelValue:l.value.dtNo,"onUpdate:modelValue":e[4]||(e[4]=n=>l.value.dtNo=n),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(w,{cols:"6"},{default:a(()=>[o(R,{label:"섹션코드",modelValue:l.value.secCode,"onUpdate:modelValue":e[5]||(e[5]=n=>l.value.secCode=n),readonly:"true",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),o(w,{cols:"6"},{default:a(()=>[o(R,{label:"품목코드",onClick:e[6]||(e[6]=n=>z("품목 조회",U.value,B)),modelValue:l.value.code,"onUpdate:modelValue":e[7]||(e[7]=n=>l.value.code=n),dense:"",outlined:"",readonly:"true"},null,8,["modelValue"])]),_:1}),o(w,{cols:"6"},{default:a(()=>[o(R,{label:"품목유형",onClick:e[8]||(e[8]=n=>z("품목 조회",U.value,B)),modelValue:l.value.type,"onUpdate:modelValue":e[9]||(e[9]=n=>l.value.type=n),readonly:"true"},null,8,["modelValue"])]),_:1})]),_:1}),o(me,{ref_key:"modalRef1",ref:r,title:f.value,rowData:$.value,colDefs:P.value,onConfirm:H},null,8,["title","rowData","colDefs"])]),D("div",De,[o(S,{justify:"center",class:"mr-3"},{default:a(()=>[o(c,{color:"error",class:"mr-3",onClick:F},{default:a(()=>e[12]||(e[12]=[u("초기화")])),_:1}),o(c,{color:"primary",class:"mr-6",onClick:K},{default:a(()=>e[13]||(e[13]=[u("저장")])),_:1})]),_:1})])])])]),_:1})],64))}},We=pe(ye,[["__scopeId","data-v-3cbb1cfb"]]);export{We as default};
