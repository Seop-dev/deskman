import{_ as K,a as J}from"./UiParentCard.vue_vue_type_script_setup_true_lang-DnD-5gIF.js";import{B as X}from"./main-Dfa23GB-.js";import{O as s,_ as Z,$ as f,a6 as ee,P as ae,q as le,o as h,a as t,w as n,V as E,b as u,c as k,a0 as d,d as te,a2 as oe,f as g,e as V,A as O,a1 as se,F as ne,a7 as re}from"./index-CGGVM91c.js";import{_ as I}from"./NewModal-RG6-e5WE.js";import{d as ie}from"./theme-bootstrap-maRaUoWN.js";import{u as ue}from"./auth-B63OrgMx.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const me={__name:"MkOutboundForm",setup(fe){var A;const m=ie.useToast(),v=ue(),M=se,x=s([]);Z(()=>{U(),P()});const S=s(0),R=s(0),P=async()=>{try{const a=await f.get("http://localhost:3000/wrNameSelect");x.value=a.data.map(e=>e.WR_NAME)}catch(a){console.error("공통코드 데이터를 불러오는 데 실패했습니다:",a)}},c=s([]),Q=s([{headerCheckboxSelection:!0,checkboxSelection:!0,width:50},{field:"제품코드",flex:1},{field:"제품명",flex:1},{field:"제품유형",flex:1},{field:"출하수량",editable:!0,flex:1},{field:"입고일자",flex:1},{field:"LOT번호",flex:1}]),l=ee({order:"",customer:"",dueDate:"",shipDate:"",writer:((A=v.user)==null?void 0:A.name)||"",wrName:"",cusId:""}),D=s(null),C=s(""),L=s([]),Y=s([]),w=[{field:"주문서번호",headerName:"주문서번호",flex:1},{field:"주문일자",headerName:"주문일자",flex:1},{field:"거래처",headerName:"거래처",flex:1},{field:"제품명",headerName:"제품명",flex:1},{field:"주문수량",headerName:"주문수량",flex:1},{field:"미납수량",headerName:"미납수량",flex:1},{field:"납기일자",headerName:"납기일자",flex:1}],p=s([]),U=async()=>{const a=await f.get("http://localhost:3000/shipModalSelect");p.value=a.data.map(e=>({주문서번호:e.REQ_ID,주문일자:e.REQ_DATE,거래처:e.CUS_ID,제품명:e.PRD_NAME,주문수량:e.REQ_QTY,미납수량:e.YET_QTY,납기일자:e.REQ_DDAY?e.REQ_DDAY.substring(0,10):null})),console.log(a)},$=async(a,e,o)=>{C.value=a,L.value=e,Y.value=o,D.value&&D.value.open()},y=s(null),b=s(""),_=s([]),N=[{field:"LOT번호",headerName:"LOT번호",flex:1},{field:"제품코드",headerName:"제품코드",flex:1},{field:"제품명",headerName:"제품명",flex:1},{field:"제품유형",headerName:"제품유형",flex:1},{field:"재고수량",headerName:"재고수량",flex:1},{field:"입고일자",headerName:"입고일자",flex:1}],B=async a=>{var r;if(!l.order){m.warning("주문서를 선택해주세요",{position:"top-right",duration:1e3});return}console.log("hi");const e={REQ_ID:l.order},o=await f.post("http://localhost:3000/shipPrdSelect",e);_.value=o.data.map(i=>({LOT번호:i.PRD_LOT,제품코드:i.PRD_CODE,제품명:i.PRD_NAME,제품유형:i.PRD_TYPE,재고수량:i.RECEIVED_QTY,입고일자:i.RECEIVED_DATE?i.RECEIVED_DATE.substring(0,10):null})),console.log(o),b.value=a,R.value++,await re(),(r=y.value)==null||r.open()};function F(a){a&&(l.order=a.주문서번호||"",l.customer=a.거래처||"",l.dueDate=a.납기일자||"",l.cusId=a.거래처코드)}function z(a){Array.isArray(a)||(a=[a]),a.forEach(e=>{c.value.unshift({제품명:e.제품명||"",제품코드:e.제품코드||"",제품유형:e.제품유형||"",출하수량:e.재고수량||"",입고일자:e.입고일자||"",LOT번호:e.LOT번호})})}function W(){var a;l.supplier="",l.orderDate="",l.dueDate="",l.manager="",l.writer=((a=v.user)==null?void 0:a.name)||"",c.value=[]}const T=s(null),j=a=>{T.value=a.api};async function q(){if(!l.order){m.warning("주문서가 조회되지 않았습니다.",{position:"top-right",duration:1e3});return}const a=T.value.getSelectedRows();if(a.length===0){m.warning("입고할 제품을 선택하세요",{position:"top-right",duration:1e3});return}console.log(a);const e=a.map(r=>({REQ_ID:l.order,CUS_ID:l.customer,PRD_LOT:r.LOT번호,SHIP_ORDER_DATE:l.shipDate,SHIP_WRITER:l.writer,WR_NAME:l.wrName,PRD_CODE:r.제품코드,PRD_NAME:r.제품명,QTY:r.출하수량,D_DAY:l.dueDate})),o=await f.post("http://localhost:3000/shipInsert",e);console.log(o),m.success("등록완료",{position:"top-right",duration:1e3})}const G=s({title:"출하지시서 등록"}),H=ae([{title:"제품 입출고",disabled:!0,href:"#"},{title:"출하지시서 등록",disabled:!1,href:"#"}]);return(a,e)=>(h(),le(ne,null,[t(K,{title:G.value.title,breadcrumbs:H.value},null,8,["title","breadcrumbs"]),t(J,{title:"출하지시서 등록"},{default:n(()=>[t(E,{class:"mb-4"},{default:n(()=>[t(u,{cols:"6"},{default:n(()=>[t(d,{label:"주문서번호",modelValue:l.order,"onUpdate:modelValue":e[1]||(e[1]=o=>l.order=o),dense:"",outlined:"",readonly:""},{"append-inner":n(()=>[te("i",{class:"fa-solid fa-magnifying-glass",style:{cursor:"pointer","font-size":"large","margin-right":"0.5rem"},onClick:e[0]||(e[0]=o=>$("주문서 조회",p.value,w))})]),_:1},8,["modelValue"]),(h(),k(I,{ref_key:"modalRef",ref:D,key:S.value,title:C.value,rowData:p.value,colDefs:w,onConfirm:F},null,8,["title","rowData"]))]),_:1}),t(u,{cols:"6"},{default:n(()=>[t(d,{label:"거래처",modelValue:l.customer,"onUpdate:modelValue":e[2]||(e[2]=o=>l.customer=o),outlined:""},null,8,["modelValue"])]),_:1}),t(u,{cols:"6"},{default:n(()=>[t(d,{label:"납기일자",modelValue:l.dueDate,"onUpdate:modelValue":e[3]||(e[3]=o=>l.dueDate=o),readonly:"true",type:"date",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(u,{cols:"6"},{default:n(()=>[t(d,{label:"출하지시일자",modelValue:l.shipDate,"onUpdate:modelValue":e[4]||(e[4]=o=>l.shipDate=o),type:"date",max:`${l.dueDate}`,dense:"",outlined:""},null,8,["modelValue","max"])]),_:1}),t(u,{cols:"6"},{default:n(()=>[t(d,{label:"작성자",modelValue:l.writer,"onUpdate:modelValue":e[5]||(e[5]=o=>l.writer=o),dense:"",outlined:""},null,8,["modelValue"])]),_:1}),t(u,{cols:"6"},{default:n(()=>[t(oe,{label:"창고명",modelValue:l.wrName,"onUpdate:modelValue":e[6]||(e[6]=o=>l.wrName=o),items:x.value,dense:"",outlined:""},null,8,["modelValue","items"])]),_:1}),t(E,{justify:"end"},{default:n(()=>[t(g,{color:"warning",class:"mr-3",onClick:e[7]||(e[7]=o=>B("입고 제품 조회",_.value,N))},{default:n(()=>e[8]||(e[8]=[V("입고 조회")])),_:1}),(h(),k(I,{ref_key:"modalRef1",ref:y,key:R.value,title:b.value,rowData:_.value,colDefs:N,onConfirm:z},null,8,["title","rowData"]))]),_:1})]),_:1}),t(O(X),{rowData:c.value,columnDefs:Q.value,theme:O(M),style:{height:"200px",width:"100%"},onCellValueChanged:a.onCellValueChanged,onGridReady:j,rowSelection:"multiple"},null,8,["rowData","columnDefs","theme","onCellValueChanged"]),t(E,{justify:"end",class:"button"},{default:n(()=>[t(g,{color:"error",class:"mr-2",onClick:W},{default:n(()=>e[9]||(e[9]=[V("초기화")])),_:1}),t(g,{color:"primary",onClick:q},{default:n(()=>e[10]||(e[10]=[V("등록")])),_:1})]),_:1})]),_:1})],64))}},Ve=de(me,[["__scopeId","data-v-db1485d2"]]);export{Ve as default};
